---
title: 竞价广告排序策略
date: 2020-05-07 10:18:50
toc: true
mathjax: true
tags:
    - 广告
    - 竞价
---

从毕业到现在一直都在从事广告行业，却从来没有写过广告相关的技术文章，也是挺不应该的。
今天就先写一篇来介绍下业内常用的竞价广告排序策略。

<!--more-->

# 概要介绍

广告行业常见术语：

* `CPM` Cost Per Thousand，千次曝光价格；最后一个字母 M 其实是罗马数字计数单位，表示 1000；
* `CPC` Cost Per Click，单次点击价格
* `CTR` Click Through Rae，点击率；点击数除以曝光数；
* `CVR` Click Value Rate，转化率；转化数除以点击数；这里的转化目标是多种多样的，可以是一个下载或者是用户填的一个表单预约；
* `pCTR` `pCVR` 预估点击率和预估转化率；当广告系统收到一次广告请求时，会基于请求里的用户信息和位置信息，
  以及广告的历史播放数据来计算出每个广告的预估点击率和预估转化率，这两个指标会影响广告的最终排序结果。

广告投放播放过程中有四个参与方：

* 广告主：花钱投广告，去推广自己的产品；例如可口可乐、红旗汽车等；
* 流量方：有大量活跃用户，会发送广告请求，展示广告进行流量变现；例如腾讯视频、QQ 空间等；
* 用户：观看广告，对于感兴趣的广告会进行点击、下载或购买等后续操作；
* 广告平台：连接广告主和流量方，广告主在广告平台投放广告，流量方从广告平台拉取广告进行展示；
  广告平台对广告进行排序以保证流量方收益最大化、广告主能按照合理的价格拿到广告展示机会、用户体验不会受到太大的影响；

广告的排序本质上是一个多方博弈的结果，最终达到一个纳什均衡的状态。

# 竞价广告排序发展历程

互联网广告最开始的投放模式和电视广告很像：分时分位置进行售卖，这里就需要销售人员去进行售卖，
售卖价格会相对较高，小的广告主无法参与进来。

## GFP (Generalized First Price)

Yahoo 在它的搜索广告中提出了一种新的广告计费方式：

* 广告主可以为广告选择特定的关键词，并设定一个价格
* 对用户搜索的关键词，按广告主的出价进行排序并返回
* 当用户点击时，按照广告主的出价直接进行扣费 

这种广告售卖方式高度自动化，不需要销售人员介入，同时很多小的广告主也可以参与进来，
提高流量的竞争激烈程度，进而可以提高流量的总收益。

GFP 的问题是无法让系统达到一个纳什均衡的状态，广告主有动力不断小幅度下调自己的出价以较低价格拿量。
这样可能会导致广告系统收入处于一个持续波动的状态。
我们假定广告主能接受的最高真实出价是 $ P\_{real} $，广告主是期望以不超过 $P_{real}$ 的成本拿到量。


## GSP (Generalized Second Pricce)

鉴于 GFP 的缺点，谷歌提出了 GSP，也就是按照第二名的出价来计费，同时谷歌还引入了质量分数的概念，
广告的排序分数按照如下的公式计算：

$$ Score = bid * quality $$

实际扣费时按照下面的公式来计算：

$$ ecpm_{second} = \frac {bid_{second} * quality_{second}} { quality_{first}} \le bid_{first} $$

我们可以证明使用 GSP 方式可以让系统到达一个纳什均衡的状态，广告主按照自己的正式意愿 $P_{real}$ 出价时是对自己最优的结果。
我们可以简单证明下，假设其它广告主的出价为 $P_{other}$，则可以分三种情况来讨论：

* $ P_{other} > P_{real} $：此时广告主最优出价为 $ \le P_{real} $ ，此时都拿不到量；
* $ P_{other} = P_{real} $：此时广告主最优出价为 $ P_{real} $；
* $ P_{other} \lt P_{real} $：此时广告主最优出价为 $ \le P_{real} $，此时可以以 $ P\_{other} $ 价格拿量；

综合上面三种情况，广告主按真实意愿 $ P_{real} $ 出价时能利益最大化。
